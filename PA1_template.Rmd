---
title: "PA1_template"
author: "kev8k"
date: "2025-10-30"
output: html_document
---
```{r}
rm(list = ls(all.names = T))
getwd()

# Load required packages
library("dplyr")

# Read the data
activity<-read.csv("C:/Users/kevin/Desktop/R Coursera/K5A1/repdata_data_activity/activity.csv")
# Convert 'date' to Date type
activity$date <- as.Date(activity$date, format = "%Y-%m-%d")

str(activity)

#Tot number of steps
##sum tot num of steps by day
steps_per_day <- activity %>%
  group_by(date) %>%
  summarise(total_steps = sum(steps, na.rm = TRUE))

head(steps_per_day)

# Plot histogram of total steps per day
hist(steps_per_day$total_steps,
     main = "Total Number of Steps Taken Each Day",
     xlab = "Total Steps per Day",
     col = "steelblue",
     breaks = 20)

# Calculate mean and median of total steps per day
mean_steps <- mean(steps_per_day$total_steps)
median_steps <- median(steps_per_day$total_steps)

mean_steps
median_steps

#avg daily activity pattern

##avg number steps in 5 min intervall
average_steps_interval <- activity %>%
  group_by(interval) %>%
  summarise(mean_steps = mean(steps, na.rm = TRUE))

plot(average_steps_interval$interval,
     average_steps_interval$mean_steps,
     type = "l",
     col = "blue",
     lwd = 2,
     xlab = "5-minute Interval",
     ylab = "Average Number of Steps",
     main = "Average Daily Activity Pattern")

max_interval <- average_steps_interval[which.max(average_steps_interval$mean_steps), ]

max_interval

#missing value

##tot number of mv
total_missing<- sum(is.na(activity$steps))
total_missing

##na replace with mean of 5 min intervall
activity_filled <- activity %>%
  left_join(average_steps_interval, by = "interval") %>%
  mutate(steps = ifelse(is.na(steps), mean_steps, steps)) %>%
  select(date, interval, steps)
## Check for any remaining NA values
sum(is.na(activity_filled$steps))

## Calculate total steps per day with imputed data
steps_per_day_filled <- activity_filled %>%
  group_by(date) %>%
  summarise(total_steps = sum(steps))

## Plot histogram of total steps per day (after imputation)
hist(steps_per_day_filled$total_steps,
     main = "Total Steps per Day (After Imputation)",
     xlab = "Total Steps per Day",
     col = "lightblue",
     breaks = 20)

## mean and median again
mean_steps_filled <- mean(steps_per_day_filled$total_steps)
median_steps_filled <- median(steps_per_day_filled$total_steps)

mean_steps_filled
median_steps_filled

## Compare to original results
mean_diff <- mean_steps_filled - mean_steps
median_diff <- median_steps_filled - median_steps

mean_diff
median_diff

#differences in activity patterns between weekdays and weekends?

activity_filled$date <- as.Date(activity_filled$date)

# Now create the weekday/weekend variable again
activity_filled$day_type <- ifelse(weekdays(activity_filled$date) %in% c("Saturday", "Sunday"),
                                   "weekend", "weekday")

activity_filled$day_type <- as.factor(activity_filled$day_type)


##Create new factor variable: weekday or weekend
activity_filled$day_type <- ifelse(weekdays(activity_filled$date) %in% c("Saturday", "Sunday"),
                                   "weekend", "weekday")

activity_filled$day_type <- as.factor(activity_filled$day_type)

##Calculate average steps per interval by day type
avg_steps_daytype <- activity_filled %>%
  group_by(interval, day_type) %>%
  summarise(mean_steps = mean(steps), .groups = "drop")

##Plot: Compare weekday vs weekend activity patterns
library(ggplot2)

ggplot(avg_steps_daytype, aes(x = interval, y = mean_steps, color = day_type)) +
  geom_line(size = 1) +
  facet_wrap(~ day_type, ncol = 1) +
  labs(title = "Average Steps per 5-Minute Interval: Weekdays vs Weekends",
       x = "5-minute Interval",
       y = "Average Number of Steps") +
  theme_minimal()

```






